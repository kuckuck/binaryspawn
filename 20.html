<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="One Time Pad in C" />
<link rel=stylesheet type=text/css href=/style.css />
<script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
<title>Binary Spawn</title>
<style>
.nav{
    border:1px solid #bcbcaf;
    border-width:1px 0;
    list-style:none;
    margin:0;
    padding:0;
    text-align:center;
}
.nav li{
    display:inline;
}
.nav a{   display:inline-block;
    padding:10px;
}
</style>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-48278659-1', 'binaryspawn.com');
  ga('send', 'pageview');

</script>

</head>
<body bgcolor=#dbdcdf text=#000000>
<body>
<ul class="nav">
  <li>[<a href=http://www.binaryspawn.com/>Home</a>]</li>
  <li>[<a href=http://www.binaryspawn.com/donate/>Donation</a>]</li>
  <li>[<a href=http://www.binaryspawn.com/resources/>Resources</a>]</li>
  <li>[<a href=http://www.binaryspawn.com/stats/>Server Stats</a>]</li>
  <li>[<a href=http://www.binaryspawn.com/irc/>Irc Info</a>]</li>
</ul>
 <div id="wrapper">

 <div id="page">
<h1><a href=http://www.binaryspawn.com/20>One Time Pad in C</a></h1>
<h3>January 21, 2020</h3>
<br>
Get the size of the file you wish to encrypt:
<p>
<pre class="prettyprint">
du -b filename
</pre>
Generate a key file:
<pre class="prettyprint">
head -c &ltsize&gt /dev/urandom > filename_key
</pre>
To encrypt:
<pre class="prettyprint">
./otp filename key output
</pre>
To decrypt:
<pre class="prettyprint">
./otp output key filename
</pre>
To compile:
<pre class="prettyprint">
gcc -Wall -g -std=gnu18 otp.c -o otp
</pre>
otp.c:
<pre class="prettyprint">
// One Time Pad

#define _GNU_SOURCE

#include &ltstdio.h&gt
#include &ltstdlib.h&gt
#include &ltsys/stat.h&gt

int main(int argc, char **argv) 
{
    FILE *input, *key, *output;

    struct stat input_info;
    struct stat key_info;

    if (argc == 4) {
        input = fopen(argv[1], "rb");
        key = fopen(argv[2], "rb");
        output = fopen(argv[3], "wb");
    }
    else {
        printf("Enter 3 valid filenames: input, key, and output.\n");
        return EXIT_FAILURE;
    }

    if (input == NULL || output == NULL || key == NULL) {
        printf("Error opening file.\n");
        return EXIT_FAILURE;
    }

    fstat(fileno(input), &input_info);
    fstat(fileno(key), &key_info);

    if (key_info.st_size < input_info.st_size) {
        printf("Keyfile must be the same size or larger than source.\n");
        return EXIT_FAILURE;
    }


    for (int i=0;;++i) {
        if (i >= input_info.st_size) break;
        fputc((fgetc(input) ^ fgetc(key)), output);
    }

    fcloseall();
    return EXIT_SUCCESS;
}
</pre>

</p>
<h2>Comments</h2>
<p>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'binaryspawn';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

<p style="text-align: center;">&#169;2013-2023 All Rights Reserved.</p>
</div>
</div>
</body>
</html>

